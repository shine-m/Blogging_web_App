{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Asus/Desktop/vs_code/uploading image/image_upload/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Asus/Desktop/vs_code/uploading image/image_upload/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Asus/Desktop/vs_code/uploading image/image_upload/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect}from\"react\";import{useState}from\"react\";import{addDoc,collection,getCountFromServer}from\"firebase/firestore\";import{db,auth,storage}from\"./firebase-config\";import{useNavigate}from\"react-router-dom\";import{getDownloadURL,ref,uploadBytes}from\"firebase/storage\";import{v4}from\"uuid\";import{isspace}from\"./Home\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CreatePost(_ref){var isAuth=_ref.isAuth;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),postText=_useState4[0],setPostText=_useState4[1];var postsCollectionRef=collection(db,\"posts\");var navigate=useNavigate();var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),urls=_useState8[0],setUrls=_useState8[1];var urlarray=[];var uploadImage=function uploadImage(){if(image===null)return;var subfolder=\"post\"+v4();for(var i=0;i<image.length;i++){var imageRef=ref(storage,\"images/\".concat(subfolder,\"/\").concat(image[i].name+v4()));uploadBytes(imageRef,image[i]).then(function(snap){getDownloadURL(snap.ref).then(function(url){urlarray.push(url);});});}setUrls(urlarray);};var createPost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var allposts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(urls===\"\"&&!isspace(title)&&!isspace(postText))){_context.next=3;break;}navigate(\"/\");return _context.abrupt(\"return\");case 3:_context.next=5;return getCountFromServer(postsCollectionRef);case 5:allposts=_context.sent;_context.next=8;return addDoc(postsCollectionRef,{title:title,postText:postText,urls:urls,number_of_posts:allposts.data().count,author:{name:auth.currentUser.displayName,id:auth.currentUser.uid}});case 8:navigate(\"/\");case 9:case\"end\":return _context.stop();}},_callee);}));return function createPost(){return _ref2.apply(this,arguments);};}();useEffect(function(){if(!isAuth){navigate(\"/login\");}},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"createPostPage\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cpContainer\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Create a Post\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"inputGp\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Title :\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Title..\",onChange:function onChange(event){setTitle(event.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"inputGp\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Post :\"}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Post...\",onChange:function onChange(event){setPostText(event.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,onChange:function onChange(event){setImage(event.target.files);}}),/*#__PURE__*/_jsx(\"br\",{}),\" \",/*#__PURE__*/_jsx(\"button\",{onClick:uploadImage,className:\"add\",children:\"ADD FILE\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:createPost,children:\"Submit Post\"})]})});}export default CreatePost;","map":{"version":3,"names":["React","useEffect","useState","addDoc","collection","getCountFromServer","db","auth","storage","useNavigate","getDownloadURL","ref","uploadBytes","v4","isspace","jsx","_jsx","jsxs","_jsxs","CreatePost","_ref","isAuth","_useState","_useState2","_slicedToArray","title","setTitle","_useState3","_useState4","postText","setPostText","postsCollectionRef","navigate","_useState5","_useState6","image","setImage","_useState7","_useState8","urls","setUrls","urlarray","uploadImage","subfolder","i","length","imageRef","concat","name","then","snap","url","push","createPost","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","allposts","wrap","_callee$","_context","prev","next","abrupt","sent","number_of_posts","data","count","author","currentUser","displayName","id","uid","stop","apply","arguments","className","children","placeholder","onChange","event","target","value","type","multiple","files","onClick"],"sources":["C:/Users/Asus/Desktop/vs_code/uploading image/image_upload/src/pages/CreatePost.js"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useState } from \"react\";\r\nimport { addDoc, collection, getCountFromServer } from \"firebase/firestore\";\r\nimport { db, auth, storage } from \"./firebase-config\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { getDownloadURL, ref, uploadBytes } from \"firebase/storage\";\r\nimport { v4 } from \"uuid\";\r\nimport { isspace } from \"./Home\";\r\n\r\nfunction CreatePost({ isAuth }) {\r\n  const [title, setTitle] = useState(\"\");\r\n  const [postText, setPostText] = useState(\"\");\r\n\r\n  const postsCollectionRef = collection(db, \"posts\");\r\n  let navigate = useNavigate();\r\n  const [image, setImage] = useState(null);\r\n  const [urls, setUrls] = useState(\"\");\r\n\r\n  const urlarray = [];\r\n  const uploadImage = () => {\r\n    if (image === null) return;\r\n\r\n    const subfolder = \"post\" + v4();\r\n    for (let i = 0; i < image.length; i++) {\r\n      const imageRef = ref(\r\n        storage,\r\n        `images/${subfolder}/${image[i].name + v4()}`\r\n      );\r\n\r\n      uploadBytes(imageRef, image[i]).then((snap) => {\r\n        getDownloadURL(snap.ref).then((url) => {\r\n          urlarray.push(url);\r\n        });\r\n      });\r\n    }\r\n    setUrls(urlarray);\r\n  };\r\n  const createPost = async () => {\r\n    if (urls === \"\" && !isspace(title) && !isspace(postText)) {\r\n      navigate(\"/\");\r\n\r\n      return;\r\n    }\r\n\r\n    const allposts = await getCountFromServer(postsCollectionRef);\r\n    await addDoc(postsCollectionRef, {\r\n      title,\r\n      postText,\r\n      urls: urls,\r\n      number_of_posts: allposts.data().count,\r\n      author: { name: auth.currentUser.displayName, id: auth.currentUser.uid },\r\n    });\r\n\r\n    navigate(\"/\");\r\n  };\r\n  useEffect(() => {\r\n    if (!isAuth) {\r\n      navigate(\"/login\");\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"createPostPage\">\r\n      <div className=\"cpContainer\">\r\n        <h1>Create a Post</h1>\r\n        <div className=\"inputGp\">\r\n          <label>Title :</label>\r\n          <input\r\n            placeholder=\"Title..\"\r\n            onChange={(event) => {\r\n              setTitle(event.target.value);\r\n            }}\r\n          />\r\n        </div>\r\n        <div className=\"inputGp\">\r\n          <label>Post :</label>\r\n          <textarea\r\n            placeholder=\"Post...\"\r\n            onChange={(event) => {\r\n              setPostText(event.target.value);\r\n            }}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <input\r\n            type=\"file\"\r\n            multiple\r\n            onChange={(event) => {\r\n              setImage(event.target.files);\r\n            }}\r\n          />\r\n          <br />{\" \"}\r\n          <button onClick={uploadImage} className=\"add\">\r\n            ADD FILE\r\n          </button>\r\n        </div>\r\n\r\n        <button onClick={createPost}>Submit Post</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CreatePost;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}